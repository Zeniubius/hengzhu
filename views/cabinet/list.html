<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>{{.siteName}}</title>
{{if .zTree}}
    <link rel="stylesheet" href="/static/zTree3/css/demo.css?t=5" type="text/css">
    <link rel="stylesheet" href="/static/zTree3/css/zTreeStyle/zTreeStyle.css" type="text/css">
{{end}}
    <link rel="stylesheet" href="/static/layui/css/layui.css">
    <link rel="stylesheet" href="/static/css/main.css">
    <script src="/static/layui/layui.js?s=36"></script>
    <script src="/static/js/main.js?s=2124"></script>
</head>
<div class="layui-layout layui-layout-admin" style="padding-left: 20px;">
    <table class="layui-table"
           lay-data="{width: 'full-10', height: 'full-105', url:'/cabinet/table', page:true, id:'idTest'}"
           lay-filter="demo">
        <thead>
        <tr>
            <th lay-data="{field:'CabinetID', width:80, fixed: true}">ID</th>
            <th lay-data="{field:'IsOnline', width:200}">在线</th>
            <th lay-data="{field:'Doors', width:150}">门数</th>
            <th lay-data="{field:'OnUse', width:200}">使用情况</th>
            <th lay-data="{field:'Close', width:200}">开关状态</th>
            <th lay-data="{field:'TypeName', width:200}">类型</th>
            <th lay-data="{field:'action', width:200}">查看</th>
            <th lay-data="{fixed:'right', width:200, align:'center', toolbar: '#barDemo'}"></th>
        </tr>
        </thead>
    </table>

    <script type="text/html" id="barDemo">
        <!--  <a class="layui-btn layui-btn-primary layui-btn-mini" lay-event="detail">查看</a> -->
        <a class="layui-btn layui-btn-mini" lay-event="edit">编辑</a>
        <a class="layui-btn layui-btn-danger layui-btn-mini" lay-event="del">删除</a>
    </script>
</div>
{{/*<script type="text/javascript">*/}}
    {{/*var URL = "/state";*/}}
    {{/*$(function () {*/}}
        {{/*$("#datagrid").datagrid({*/}}
            {{/*title: '状态',*/}}
            {{/*url: URL + "/index",*/}}
            {{/*method: 'POST',*/}}
            {{/*pagination: true,*/}}
            {{/*fitColumns: true,*/}}
            {{/*striped: true,*/}}
            {{/*rownumbers: true,*/}}
            {{/*singleSelect: true,*/}}
            {{/*idField: 'Id',*/}}
            {{/*columns: [[*/}}
                {{/*{*/}}
                    {{/*field: 'CabinetID', title: 'ID', width: 50, align: 'center',*/}}
                    {{/*formatter: function (value, row) {*/}}
                        {{/*if (row.IsOnline == "否") {*/}}
                            {{/*return "<span style='color: gray'>" + value + "</span>"*/}}
                        {{/*}*/}}
                        {{/*return value*/}}
                    {{/*}*/}}
                {{/*},*/}}
                {{/*{*/}}
                    {{/*field: 'IsOnline', title: '在线', width: 150, align: 'center',*/}}
                    {{/*formatter: function (value, row) {*/}}
                        {{/*if (row.IsOnline == "否") {*/}}
                            {{/*return "<span style='color: gray'>" + value + "</span>"*/}}
                        {{/*}*/}}
                        {{/*return value*/}}
                    {{/*}*/}}
                {{/*},*/}}
                {{/*{*/}}
                    {{/*field: 'Doors', title: '门数', width: 250, align: 'center',*/}}
                    {{/*formatter: function (value, row) {*/}}
                        {{/*if (row.IsOnline == "否") {*/}}
                            {{/*return "<span style='color: gray'>" + value + "</span>"*/}}
                        {{/*}*/}}
                        {{/*return value*/}}
                    {{/*}*/}}
                {{/*},*/}}
                {{/*{*/}}
                    {{/*field: 'OnUse', title: '使用情况', width: 100, align: 'center',*/}}
                    {{/*formatter: function (value, row) {*/}}
                        {{/*if (row.IsOnline == "否") {*/}}
                            {{/*return "<span style='color: gray'>" + value + "/" + row.Doors + "</span>"*/}}
                        {{/*}*/}}
                        {{/*return value + "/" + row.Doors*/}}
                    {{/*}*/}}
                {{/*},*/}}
                {{/*{*/}}
                    {{/*field: 'Close', title: '开关状态', width: 200, align: 'center',*/}}
                    {{/*formatter: function (value, row) {*/}}
                        {{/*if (row.IsOnline == "否") {*/}}
                            {{/*return "<span style='color: gray'>" + value + "/" + row.Doors + "</span>"*/}}
                        {{/*}*/}}
                        {{/*return value + "/" + row.Doors*/}}
                    {{/*}*/}}
                {{/*},*/}}
                {{/*{*/}}
                    {{/*field: 'TypeName', title: '类型', width: 200, align: 'center',*/}}
                    {{/*formatter: function (value, row) {*/}}
                        {{/*if (row.IsOnline == "否") {*/}}
                            {{/*return "<span style='color: gray'>" + value + "</span>"*/}}
                        {{/*}*/}}
                        {{/*return value*/}}
                    {{/*}*/}}
                {{/*},*/}}
                {{/*{*/}}
                    {{/*field: 'action', title: '查看', width: 200, align: 'center',*/}}
                    {{/*formatter:function(value,row){*/}}
                        {{/*var a = '<a href="/state/detail/'+row.Id+'" icon="icon-add" plain="true" class="easyui-linkbutton" target="_self">详情</a>'*/}}
                        {{/*return a;*/}}
                    {{/*}*/}}
                {{/*}*/}}
            {{/*]],*/}}
        {{/*});*/}}
    {{/*})*/}}
    {{/*//创建状态详情窗口*/}}
    {{/*/*$("#dialog").dialog({*/}}
        {{/*modal:true,*/}}
        {{/*resizable:true,*/}}
        {{/*top:50,*/}}
        {{/*closed:true,*/}}
        {{/*buttons:[{*/}}
            {{/*text:'保存',*/}}
            {{/*iconCls:'icon-save',*/}}
            {{/*handler:function(){*/}}
                {{/*$("#form1").form('submit',{*/}}
                    {{/*url:URL+'/AddUser',*/}}
                    {{/*onSubmit:function(){*/}}
                        {{/*return $("#form1").form('validate');*/}}
                    {{/*},*/}}
                    {{/*success:function(r){*/}}
                        {{/*var r = $.parseJSON( r );*/}}
                        {{/*if(r.status){*/}}
                            {{/*$("#dialog").dialog("close");*/}}
                            {{/*$("#datagrid").datagrid('reload');*/}}
                        {{/*}else{*/}}
                            {{/*vac.alert(r.info);*/}}
                        {{/*}*/}}
                    {{/*}*/}}
                {{/*});*/}}
            {{/*}*/}}
        {{/*},{*/}}
            {{/*text:'取消',*/}}
            {{/*iconCls:'icon-cancel',*/}}
            {{/*handler:function(){*/}}
                {{/*$("#dialog").dialog("close");*/}}
            {{/*}*/}}
        {{/*}]*/}}
    {{/*});*/}}
    {{/*//状态详情弹窗*/}}
    {{/*// function detail(id){*/}}
    {{/*//     $("#dialog").dialog('open');*/}}
    {{/*//     $("#form1").form('clear');*/}}
    {{/*// }*/}}
    {{/*//刷新*/}}
    {{/*function reloadrow() {*/}}
        {{/*$("#datagrid").datagrid("reload");*/}}
    {{/*}*/}}


{{/*</script>*/}}
<body>
<script>
    var $;
    layui.config({
            base : "js/"
    }).use(['table','element','layer','jquery'], function(){
        var table = layui.table;
        var element = layui.element;
        $ = layui.jquery
    //监听表格复选框选择
    table.on('checkbox(demo)', function(obj){
        console.log(obj);
    });

    //监听工具条
    table.on('tool(demo)', function(obj){
        var data = obj.data;
        if(obj.event === 'detail'){
            //layer.msg('ID：'+ data.id + ' 的查看操作');
        } else if(obj.event === 'del'){
            if (data.id==1) {
               layer.msg('超级管理员不允许删除');
               return false;
            }
            layer.confirm('真的删除【'+data.login_name+'】账号么', function(index){
            var jsData = {'id':data.id}
            $.post('{{urlfor "AdminController.AjaxDel"}}', jsData, function (out) {
                if (out.status == 0) {
                    layer.alert('删除成功了', {icon: 1},function(index){
                        layer.close(index);
                        window.location.reload();
                    });
                } else {
                    layer.msg(out.message)
                }
            }, "json");
            // obj.del();
            layer.close(index);
        });
        } else if(obj.event === 'edit'){
            window.location.href="/admin/edit?id="+data.id
        }
    });
});
</script>
</body>
</html>